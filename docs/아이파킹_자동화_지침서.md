# 아이파킹 멤버 사이트 자동화 지침서

## 개요
아이파킹 멤버 사이트(http://members.iparking.co.kr/)에서 차량번호 검색 및 할인권 적용을 자동화하는 지침서입니다.

## 사전 준비사항
- 유효한 아이파킹 멤버 계정 (아이디/비밀번호)
- 차량번호 4자리
- Chrome DevTools MCP 도구

## 자동화 프로세스

### 1단계: 사이트 접속 및 초기 팝업 처리
1. **사이트 접속**: `http://members.iparking.co.kr/`
2. **초기 팝업 닫기**: "Skip" 버튼 클릭
3. **고객센터 안내 팝업 닫기**: "다시 보지 않기" 버튼 클릭

### 2단계: 로그인
1. **아이디 입력**: 계정 아이디 입력
2. **비밀번호 입력**: 계정 비밀번호 입력
3. **로그인 버튼 클릭**
4. **로그인 후 팝업 처리**:
   - 첫 번째 팝업: "닫기" 버튼 클릭
   - 두 번째 팝업: "닫기" 버튼 클릭

### 3단계: 차량번호 검색
1. **차량번호 입력**: 4자리 차량번호 입력
2. **검색 버튼 클릭**
3. **차량 선택**: 검색 결과에서 해당 차량의 "차량 선택" 버튼 클릭

### 4단계: 할인권 적용
1. **보유 할인권 테이블 확인**
2. **30분할인권(무료) 적용**:
   - "적용" 버튼 클릭
   - "적용하시겠습니까?" 팝업에서 "확인" 클릭
   - "할인권 1장이 적용되었습니다." 팝업에서 "확인" 클릭
3. **1시간할인권(유료) 적용**:
   - "적용" 버튼 클릭
   - "적용하시겠습니까?" 팝업에서 "확인" 클릭
   - "할인권 1장이 적용되었습니다." 팝업에서 "확인" 클릭

## API 정보

### 인증 관련 API
```
POST http://oauth.parkingcloud.co.kr/api/oauth/store/authorize
Headers:
- Content-Type: application/json
- Origin: http://members.iparking.co.kr
Body: 로그인 정보 (아이디/비밀번호)
```

### 멤버 관련 API
```
POST http://members.iparking.co.kr/api/members/store/list/{userId}
Headers:
- Authorization: {토큰}
- Content-Type: application/json;charset=UTF-8
- Version: 2.0.0
- Referer: http://members.iparking.co.kr/html/home.html
```

```
POST http://members.iparking.co.kr/api/members/parkinglot/list/{storeId}
Headers:
- Authorization: {토큰}
- Content-Type: application/json;charset=UTF-8
- Version: 2.0.0
- Referer: http://members.iparking.co.kr/html/home.html
```

```
POST http://members.iparking.co.kr/api/members/discount/product/list
Headers:
- Authorization: {토큰}
- Content-Type: application/json;charset=UTF-8
- Version: 2.0.0
- Referer: http://members.iparking.co.kr/html/home.html
```

### 알림 관련 API
```
GET http://members.iparking.co.kr/api/members/notice/alram/popup?_={timestamp}
Headers:
- Accept: application/json, text/javascript, */*; q=0.01
- Content-Type: application/json;charset=UTF-8
- Version: 2.0.0
- Referer: http://members.iparking.co.kr/
```

## UI 요소 식별자 (UID)

### 로그인 페이지
- 아이디 입력란: `textbox "아이디"`
- 비밀번호 입력란: `textbox "비밀번호"`
- 로그인 버튼: `button "로그인"`

### 메인 페이지
- 차량번호 입력란: `textbox "1234"`
- 검색 버튼: `button "검색"`
- 매장 선택: `combobox "704호"`

### 차량 선택 페이지
- 차량 선택 버튼: `button "차량 선택"`

### 할인권 적용 페이지
- 30분할인권 적용 버튼: `button "적용"` (30분할인권 섹션)
- 1시간할인권 적용 버튼: `button "적용"` (1시간할인권 섹션)
- 확인 버튼: `button "확인"`
- 취소 버튼: `button "취소"`

## 팝업 처리 순서

### 초기 팝업들
1. "Skip" 버튼 클릭
2. "다시 보지 않기" 버튼 클릭

### 로그인 후 팝업들
1. 첫 번째 팝업: "닫기" 버튼 클릭
2. 두 번째 팝업: "닫기" 버튼 클릭

### 할인권 적용 팝업들
1. "적용하시겠습니까?" 팝업: "확인" 버튼 클릭
2. "할인권 1장이 적용되었습니다." 팝업: "확인" 버튼 클릭

## 주의사항

### 팝업 처리
- 로그인 후에는 반드시 **2개의 팝업**이 순차적으로 나타남
- 각 팝업을 순서대로 닫아야 함
- 팝업을 건너뛰면 다음 단계로 진행할 수 없음

### 할인권 적용
- 30분할인권(무료)과 1시간할인권(유료) 각각 별도로 적용
- 각 할인권 적용 시마다 2단계 팝업 확인 과정 필요
- 할인권 잔여 횟수 확인 후 적용 가능 여부 판단

### 네트워크 요청
- 모든 API 요청은 인증 토큰 필요
- 요청 실패 시 재시도 로직 구현 필요
- 응답 시간 고려한 타임아웃 설정

## 에러 처리

### 로그인 실패
- "존재하지 않는 ID입니다." 메시지 확인
- 계정 정보 재확인 필요

### 차량 검색 실패
- "검색 결과가 나오지 않을 수 있습니다." 메시지 확인
- 차량번호 재확인 필요

### 할인권 적용 실패
- 버튼 비활성화 상태 확인
- 잔여 횟수 확인
- 네트워크 연결 상태 확인

## 테스트 계정 정보
- 아이디: dtctrit2704
- 비밀번호: dtctrit2704
- 테스트 차량번호: 1255

## 성공 기준
- 로그인 성공
- 차량번호 검색 성공
- 차량 선택 성공
- 30분할인권(무료) 적용 성공
- 1시간할인권(유료) 적용 성공
- 모든 팝업 정상 처리

## 자동화 스크립트 예시

```javascript
// 1. 사이트 접속
navigate('http://members.iparking.co.kr/');

// 2. 초기 팝업 처리
click('Skip');
click('다시 보지 않기');

// 3. 로그인
fill('아이디', 'dtctrit2704');
fill('비밀번호', 'dtctrit2704');
click('로그인');

// 4. 로그인 후 팝업 처리
click('닫기'); // 첫 번째 팝업
click('닫기'); // 두 번째 팝업

// 5. 차량번호 검색
fill('차량번호', '1255');
click('검색');

// 6. 차량 선택
click('차량 선택');

// 7. 할인권 적용
click('30분할인권 적용');
click('확인');
click('확인');

click('1시간할인권 적용');
click('확인');
click('확인');
```

이 지침서를 참고하여 아이파킹 멤버 사이트의 자동화를 구현할 수 있습니다.
